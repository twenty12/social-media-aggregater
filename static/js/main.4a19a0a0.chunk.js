(this.webpackJsonpapp=this.webpackJsonpapp||[]).push([[0],{43:function(e,t,c){},44:function(e,t,c){},45:function(e,t,c){"use strict";c.r(t);var n=c(1),a=c(0),s=c(17),r=c.n(s),o=c(3),i=c(10),j={"vendee-globe":"Vend\xe9e Globe","americas-cup":"America's Cup"};function u(){var e=Object(o.f)().eventSlug;return Object(n.jsx)("nav",{className:"navbar navbar-default border-bottom",children:Object(n.jsxs)("div",{className:"",children:[Object(n.jsxs)("h1",{className:"mb-n3",children:[Object(n.jsx)(i.b,{to:"/",children:"Spun"})," | ",j[e]]}),Object(n.jsx)("br",{}),Object(n.jsx)("div",{className:"mb-n2 mt-n1"})]})})}var l=function(){return Object(n.jsxs)("div",{className:"container",children:["Content streams from the great regettas.",Object(n.jsxs)("ul",{children:[Object(n.jsx)("li",{children:Object(n.jsx)(i.b,{to:"race/vendee-globe",children:"The Vendee Globe"})}),Object(n.jsx)("li",{children:Object(n.jsx)(i.b,{to:"race/americas-cup",children:"The America's Cup"})})]})]})},d=c(16),b={UK:"\ud83c\uddec\ud83c\udde7",JPN:"\ud83c\uddef\ud83c\uddf5",DE:"\ud83c\udde9\ud83c\uddea",FRN:"\ud83c\uddeb\ud83c\uddf7",CH:"\ud83c\udde8\ud83c\udded",IT:"\ud83c\uddee\ud83c\uddf9"},O=function(e){var t=e.postData,c=e.accountData,s=Object(a.useState)(!0),r=Object(d.a)(s,2),o=r[0],i=r[1],j=Object(n.jsx)("img",{className:"img-fluid",src:t.thumbnail}),u=Object(n.jsx)("div",{className:"embed-responsive embed-responsive-16by9",children:Object(n.jsx)("iframe",{className:"embed-responsive-item border-0",src:"https://www.youtube.com/embed/".concat(t.source_id,"?&autoplay=1"),allow:"autoplay; encrypted-media",title:"video"})});return Object(n.jsx)("div",{className:"row justify-content-center",children:Object(n.jsx)("div",{className:"my-2 col-sm-12 col-md-8",children:Object(n.jsxs)("div",{className:"card border-dark",children:[Object(n.jsx)("div",{className:"card-header bg-white border-0 pb-0",children:function(){var e,a,s=new Date(t.created);if(0!=Object.keys(c).length){var r;return Object(n.jsxs)("div",{children:[Object(n.jsxs)("div",{className:"d-flex",children:[Object(n.jsx)("div",{className:"mr-auto ",children:c.sailor?c.sailor.name:c.name}),Object(n.jsx)("small",{className:"mt-2 mb-n2",children:c.sailor?(e=s.toLocaleString(),a=RegExp(","),e.split(a).map((function(e){return RegExp(":").test(e)?Object(n.jsx)("span",{className:"d-block d-md-inline",children:e}):e}))):""})]}),Object(n.jsx)("small",{children:Object(n.jsxs)("i",{children:[c.sailor?null===(r=c.sailor.boat)||void 0===r?void 0:r.name:""," ",b[c.flag]," "]})}),Object(n.jsx)("br",{})]})}}()}),Object(n.jsx)("div",{onClick:function(){return i(!1)},className:"card-body d-flex justify-content-center",children:o?j:u}),Object(n.jsx)("div",{className:"card-footer bg-white border-0 pt-0"})]})})},t.id)},m=c(5),h=c(13),f=c(9);function p(e,t){return{type:e,payload:t}}var v={posts:[],loading:!0,pageNumber:1,showInfo:!1},x=function(e,t){return function(c){fetch(function(e,t){return"https://social-media-aggregater.herokuapp.com/api/posts/?page="+e+"&account__events__name="+t}(e,t)).then((function(e){return e.json()})).then((function(e){c(p("posts/ADD_POSTS",e.results))}))}};var g={accounts:[],timePassedSinceUpdate:0,counting:!1},N=function(e){return function(t){fetch("https://social-media-aggregater.herokuapp.com/api/accounts/?events__name="+e).then((function(e){return e.json()})).then((function(e){t(p("teams/ADD_ACCOUNT",e.results))}))}},y=function(){return function(e){e(p("teams/CLOCK_TIME"))}};var _=c(28),w=function(e){return e<=9999?"000".concat(e).slice(-2):e};var T=function(){var e=Object(m.b)(),t=Object(m.c)((function(e){return e.post.pageNumber})),c=(Object(m.c)((function(e){return e.team.timePassedSinceUpdate})),Object(m.c)((function(e){return e.team.counting}))),s=Object(o.f)().eventSlug,r=Object(m.c)((function(e){return e.post.showInfo}));Object(a.useEffect)((function(){console.log("render"),e(N(s)),e(x(t,s))}),[]),Object(a.useEffect)((function(){if(c){var t=setInterval((function(){e(y())}),1e3);return function(){return clearInterval(t)}}}),[c]);var i,j=Object(m.c)((function(e){return e.post.posts})),u=Object(m.c)((function(e){return e.post.loading}))?Object(n.jsx)("h1",{children:"Loading..."}):"",l=(i=Object(m.c)((function(e){return e.team.accounts})),console.log("array to key"),console.log(i),i.reduce((function(e,t,c){return e[t.id]=t,e}),{})),b=j.map((function(e){return Object(n.jsx)(O,{postData:e,accountData:0===Object.keys(l).length?{}:l[e.account]})})),h=Object(a.useRef)(null);(function(e){var t=Object(a.useState)(!1),c=Object(d.a)(t,2),n=c[0],s=c[1],r=new IntersectionObserver((function(e){var t=Object(d.a)(e,1)[0];return s(t.isIntersecting)}));return Object(a.useEffect)((function(){return r.observe(e.current),function(){r.disconnect()}}),[]),n})(h)&&t>1&&e(x(t,s));var f=function(t){c||e(p("teams/START_COUNTER"));var n=new Date(t),a=(new Date).getTime()-n.getTime();a/=1e3;var s=Math.round(a%60);a=Math.floor(a/60);var r=Math.round(a%60);a=Math.floor(a/60);var o=Math.round(a%24);return a=Math.floor(a/24),w(o)+":"+w(r)+":"+w(s)};return Object(n.jsxs)("div",{className:"container",children:[Object(n.jsxs)("div",{className:"row justify-content-center",children:[Object(n.jsx)("div",{className:"col-sm-12 mt-1 col-md-8 d-flex",children:Object(n.jsx)(_.a,{onClick:function(){return e(p("posts/TOGGLE_INFO"))}})}),function(){if(r)return Object(n.jsx)("div",{className:"col-sm-12 mt-1 col-md-8 d-flex",children:Object(n.jsx)("div",{className:"card border-dark w-100 ",children:Object(n.jsxs)("div",{className:"card-body py-1",children:[Object(n.jsx)("div",{children:Object(n.jsxs)("small",{children:["Accounts monitored: ",Object.keys(l).length]})}),Object(n.jsx)("div",{children:Object(n.jsxs)("small",{children:["Time since YouTube check: ",Object.keys(l).length<2?"":f(l[Object.keys(l)[0]].updated)]})})]})})})}()]}),b,u,Object(n.jsx)("div",{ref:h})]})};c(43),c(44);var S=function(){return Object(m.b)(),Object(m.c)((function(e){return e.post.pageNumber})),Object(n.jsx)(i.a,{children:Object(n.jsxs)(o.c,{children:[Object(n.jsxs)(o.a,{path:"/race/:eventSlug",children:[Object(n.jsx)(u,{}),Object(n.jsx)(T,{})]}),Object(n.jsxs)(o.a,{path:"/",children:[Object(n.jsx)(u,{}),Object(n.jsx)(l,{})]})]})})},D=c(11),E=Object(D.c)({post:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:v,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"posts/ADD_POSTS":return Object(f.a)(Object(f.a)({},e),{},{loading:!1,pageNumber:e.pageNumber+1,posts:[].concat(Object(h.a)(e.posts),Object(h.a)(t.payload))});case"posts/TOGGLE_INFO":return Object(f.a)(Object(f.a)({},e),{},{showInfo:!e.showInfo});default:return e}},team:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:g,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"teams/ADD_ACCOUNT":return Object(f.a)(Object(f.a)({},e),{},{accounts:[].concat(Object(h.a)(e.accounts),Object(h.a)(t.payload))});case"teams/CLOCK_TIME":return Object(f.a)(Object(f.a)({},e),{},{timePassedSinceUpdate:e.timePassedSinceUpdate+1});case"teams/START_COUNTER":return Object(f.a)(Object(f.a)({},e),{},{counting:!0});default:return e}}}),C=c(27),k=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||D.d,I=Object(D.e)(E,k(Object(D.a)(C.a)));r.a.render(Object(n.jsx)(m.a,{store:I,children:Object(n.jsx)(S,{})}),document.getElementById("root"))}},[[45,1,2]]]);
//# sourceMappingURL=main.4a19a0a0.chunk.js.map